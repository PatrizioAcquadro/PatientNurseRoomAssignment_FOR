# Patient–Nurse–Room Assignment (MIP)
## Overview
We model a hospital scheduling problem over a 7‑day horizon: assign each **patient** a **room** and decide **one nurse per occupied room per day**. Goal: **minimize total admission delay** (start day − release day), subject to room capacity, patient–room incompatibilities, nurse availability, and 
≤3 rooms per nurse per day.

### Why MIP?
Binary decisions (start day/room, nurse assignment) + linear capacity/compatibility/availability constraints → a clean Mixed‑Integer Linear Program solved to optimality.

---

## Data (example instance)
- **Days:** 7
- **Rooms (5):** capacities = {3,2,2,2,2}
- **Patients (20):** length of stay, release and due dates, incompatible rooms
- **Nurses (5):** shift sets by day; ≤3 rooms/day

> The full instance (and tables of assignments) are documented in the project report under `docs/`.

---

## Model
**Sets**
- Patients *i ∈ I*; Rooms *r ∈ R*; Days *t ∈ D*; Nurses *n ∈ N*
- Incompᵢ ⊆ R (room incompatibilities), Shiftsₙ ⊆ D (nurse availability)

**Parameters**
- Capᵣ (room capacity); Lᵢ (length of stay); Relᵢ (release); Dueᵢ (due)

**Decision Variables**
- xᵢᵣᵈ ∈ {0,1}: patient *i* starts in room *r* on day *d*
- yʳᵗₙ ∈ {0,1}: nurse *n* assigned to room *r* on day *t*
- zʳᵗ ∈ {0,1}: room *r* is occupied on day *t*

**Objective**
- Minimize Σᵢ Σᵣ Σ_{d∈[Relᵢ,Dueᵢ]} (d − Relᵢ) · xᵢᵣᵈ

**Key Constraints (sketch)**
1) Unique admission: Σᵣ Σ_d xᵢᵣᵈ = 1 ∀i
2) Capacity by day: Σ_{i,d: d≤t<d+Lᵢ} xᵢᵣᵈ ≤ Capᵣ ∀r,t
3) Incompatibility: xᵢᵣᵈ = 0 if r ∈ Incompᵢ
4) Window: xᵢᵣᵈ = 0 if d∉[Relᵢ,Dueᵢ]
5) Room occupancy ↔ nurse: bind zʳᵗ to occupancy; Σₙ yʳᵗₙ = zʳᵗ
6) Nurse availability: yʳᵗₙ = 0 if t∉Shiftsₙ
7) Load limit: Σᵣ yʳᵗₙ ≤ 3 ∀n,t

---

## Algorithm
**Exact** Branch‑and‑Bound (potentially with cutting planes):
- Solve LP relaxations for bounds; prune when bound ≥ best known.
- Branch on fractional binaries (e.g., some xᵢᵣᵈ).
- Stop with globally optimal integer solution when tree exhausted/pruned.

**Complexity**
- Worst‑case exponential in #binaries B ≈ |I||R||D| + |R||D||N| (NP‑hard MILP).
- In practice, relaxations, cuts, and good branching rules make instances solvable quickly.

---

## How to Run
### Option A — Notebook
Open `AcquadroDrugman_BigProject_FOR.ipynb` and run all cells:
1. Install deps: `pip install mip pandas numpy`
2. Execute: the notebook builds the MILP (CBC via `mip` by default), solves, and prints/exports assignment tables.

### Option B — Script (skeleton)
```
python solve.py --data data/instance.json --solver cbc --time-limit 300
```
> Provide a JSON matching the sets/parameters above; the script emits patient‑to‑room, nurse‑to‑room‑by‑day, and objective value.

---

## Repository Structure (suggested)
```
.
├─ notebooks/
│  └─ AcquadroDrugman_BigProject_FOR.ipynb
├─ src/
│  ├─ model.py          # build MILP (variables, constraints, objective)
│  ├─ data.py           # load/validate instance JSON
│  ├─ solve.py          # CLI wrapper (args, solver config, I/O)
│  └─ utils.py          # formatting, feasibility checks
├─ data/
│  └─ instance.json     # example instance (if distributable)
├─ docs/
│  └─ FOR_BIG_PROJECT_REPORT.pdf
└─ README.md
```

---

## Results
- The report includes **tables of patient→room/day** and **nurse→room/day** assignments and the **objective value** (total admission delay).
- Exported CSV/Markdown can be generated by the notebook (`outputs/`).

---

## Reproducibility & Tips
- Fix a solver seed and time limit for consistent runs.
- Validate instance feasibility early (capacity vs. demand; nurse coverage).
- Add unit tests for constraints (e.g., per‑day capacity, single‑start per patient).

---

## Authors & Roles
**Patrizio Acquadro, Tito Nicola Drugman, David Gadiaga**
MSc Computer Science - Artificial Intelligence (T2i)
Milan, Politecnico di Milano

---

## License
Course deliverable — All rights reserved.
